"0",""
"0","# Calculate speed"
"0","flights_dt[, speed_mph := distance / (air_time / 60)]"
"0","flights_dt <- flights_dt[!is.na(speed_mph)] # Exclude rows with NA speeds"
"0",""
"0","# Find the aircraft with the fastest average speed"
"0","fastest_aircraft <- flights_dt["
"0","  , .("
"0","    avg_speed = mean(speed_mph, na.rm = TRUE),"
"0","    num_flights = .N"
"0","  ), by = tailnum"
"0","]["
"0","  order(-avg_speed)"
"0","]["
"0","  1"
"0","]"
"0",""
"0","if (nrow(fastest_aircraft) == 0) {"
"0","  fastest_model <- data.table(model = NA, avg_speed = NA, num_flights = NA)"
"0","} else {"
"0","  # Join with planes to get the model"
"0","  fastest_model <- fastest_aircraft["
"0","    planes_dt, on = ""tailnum"", nomatch = 0"
"0","  ]["
"0","    , .(model, avg_speed, num_flights)"
"0","  ]"
"0","}"
"0",""
"0","# Display the fastest model"
"0","fastest_model"
