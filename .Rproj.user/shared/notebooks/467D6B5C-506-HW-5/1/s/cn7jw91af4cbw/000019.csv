"0",""
"0","# Arrival delay summary"
"0","arrival_delay_summary <- flights_dt["
"0","  !is.na(arr_delay), # Exclude rows with NA arr_delay"
"0","  .("
"0","    mean_arr_delay = mean(arr_delay, na.rm = TRUE),"
"0","    median_arr_delay = median(arr_delay, na.rm = TRUE),"
"0","    num_flights = .N"
"0","  ), by = dest"
"0","]["
"0","  num_flights >= 10"
"0","]["
"0","  order(-mean_arr_delay)"
"0","]["
"0","  airports_dt, on = .(dest = faa), nomatch = 0"
"0","]["
"0","  , .(name, mean_arr_delay, median_arr_delay, num_flights) # Use the column directly after the join"
"0","]"
"0",""
"0","if (nrow(arrival_delay_summary) == 0) {"
"0","  arrival_delay_summary <- data.table(name = NA, mean_arr_delay = NA, median_arr_delay = NA, num_flights = NA)"
"0","}"
"0",""
"0","kable(arrival_delay_summary, align = 'c')"
